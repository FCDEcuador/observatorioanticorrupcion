function loadCaseStageDetail(e,o){var a=$("#case_stage").val();if(""!=a)$.get(e+"/"+a,function(e){var a=$("#case_stage_detail");a.empty(),a.append("<option value=''>Seleccione un detalle de etapa</option>"),$.each(e,function(e,i){i.description==o?a.append("<option value='"+i.description+"' selected='selected'>"+i.description+"</option>"):a.append("<option value='"+i.description+"'>"+i.description+"</option>")})});else{console.log("No se ha seleccionado ninguna etapa del caso");var i=$("#case_stage_detail");i.empty(),i.append("<option value=''>Seleccione un detalle de etapa</option>")}}function addWhatHappened(){nextWH++;var e='<div class="row" id="whatHappenedDiv_'+nextWH+'"><div class="col-md-1"><label for="order"> Orden: </label><input type="number" name="order[]" id="order_'+nextWH+'" class="form-control" value="" /></div><div class="col-md-6"><div class="row"><div class="col-md-4"><label for="year"> Año Inicio: </label><input type="number" name="year[]" id="year_1" class="form-control" /></div><div class="col-md-4"><label for="year"> Mes Inicio: </label><select name="month[]" id="month_'+nextWH+'" class="form-control"><option value="" selected="selected">Mes</option><option value="Enero">Enero</option><option value="Febrero">Febrero</option><option value="Marzo">Marzo</option><option value="Abril">Abril</option><option value="Mayo">Mayo</option><option value="Junio">Junio</option><option value="Julio">Julio</option><option value="Agosto">Agosto</option><option value="Septiembre">Septiembre</option><option value="Octubre">Octubre</option><option value="Noviembre">Noviembre</option><option value="Diciembre">Diciembre</option></select></div><div class="col-md-4"><label for="day"> Día Inicio: </label><input type="number" name="day[]" id="day_'+nextWH+'" class="form-control" /></div><div class="col-md-4"><label for="year_end"> Año Fin: </label><input type="number" name="year_end[]" id="year_end_'+nextWH+'" class="form-control" /></div><div class="col-md-4"><label for="month_end"> Mes Fin: </label><select name="month_end[]" id="month_end_'+nextWH+'" class="form-control"><option value="" selected="selected">Mes</option><option value="Enero">Enero</option><option value="Febrero">Febrero</option><option value="Marzo">Marzo</option><option value="Abril">Abril</option><option value="Mayo">Mayo</option><option value="Junio">Junio</option><option value="Julio">Julio</option><option value="Agosto">Agosto</option><option value="Septiembre">Septiembre</option><option value="Octubre">Octubre</option><option value="Noviembre">Noviembre</option><option value="Diciembre">Diciembre</option></select></div><div class="col-md-4"><label for="day_end"> Día Fin: </label><input type="number" name="day_end[]" id="day_end_'+nextWH+'" class="form-control" /></div></div></div><div class="col-md-3"><label for="day"> Descripción: </label><textarea name="description[]" id="description_'+nextWH+'" class="form-control"></textarea></div><div class="col-md-2"><a class="btn btn-danger" style="cursor: pointer; color:#FFF;" onclick="javascript: $(\'#whatHappenedDiv_'+nextWH+'\').remove();" title="Eliminar linea"><i class="fa fa-trash"></i></a></div></div>';$("#whatHappenedDiv").append(e)}function deleteWhatHappened(e,o){swal({title:"Casos de Corrupción",text:"Está seguro que desea eliminar éste registro?",type:"warning",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!0,confirmButtonClass:"success",cancelButtonClass:"danger",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"Si, Eliminar",cancelButtonText:"No, Cancelar"},function(a){if(a)return $.ajax({type:"GET",url:e,dataType:"json",beforeSend:function(){$(".preloader").show()},success:function(e){$(".preloader").fadeOut(),1==e.status?($("#whatHappenedDiv_"+o).remove(),showAlert("Casos de Corrupción",e.message,"success")):showAlert("Casos de Corrupción",e.message,"error")},error:function(e){$(".preloader").fadeOut();var o=e.responseJSON;o&&$.each(o,function(e){console.log(o[e])}),showAlert("ERROR","Ups!. Parece que por el momento el sistema no esta disponible, por favor intentelo nuevamente luego de unos minutos","error")}}),!1})}var FormCorruptionCaseValidation=function(){var e=function(){var e=$("#corruptionCaseForm"),o=$(".alert-danger",e),a=$(".alert-success",e);e.steps({headerTag:"h6",bodyTag:"section",transitionEffect:"fade",titleTemplate:'<span class="step">#index#</span> #title#',labels:{next:"Siguiente",previous:"Anterior",finish:"Validar"},onStepChanging:function(o,a,i){return a>i||!(3===i&&Number($("#age-2").val())<18)&&(a<i&&(e.find(".body:eq("+i+") label.error").remove(),e.find(".body:eq("+i+") .error").removeClass("error")),e.validate().settings.ignore=":disabled,:hidden",e.valid())},onFinishing:function(o,a){return e.validate().settings.ignore=":disabled",e.valid()},onFinished:function(e,o){$("#corruptionCaseBtn").show()}}),e.validate({errorElement:"div",errorClass:"form-control-feedback",focusInvalid:!0,ignore:"",rules:{case_stage:{required:!0},province:{required:!0},state_function:{required:!0},involved_number:{required:!0,digits:!0},"linked_institutions[]":{required:!0,minlength:1},"public_officials_involved[]":{required:!0,minlength:1},summary:{required:function(){CKEDITOR.instances.summary.updateElement()}},main_multimedia:{accept:"image/*"},home_image:{accept:"image/*"},title:{required:!0},history:{required:function(){CKEDITOR.instances.history.updateElement()}},history_image:{accept:"image/*"},consequences_image:{accept:"image/*"}},messages:{case_stage:{required:"Por favor seleccione la Etapa Actual del Caso"},province:{required:"Por favor seleccione la provincia"},state_function:{required:"Por favor seleccione la Función del Estado"},involved_number:{required:"Por favor ingrese el número de funcionarios involucrados",digits:"Por favor ingrese un número válido"},"linked_institutions[]":{required:"Por favor seleccione al menos 1 Institución Vinculada",minlength:"Por favor seleccione al menos 1 Institución Vinculada"},"public_officials_involved[]":{required:"Por favor seleccione al menos 1 Funcionario involucrado",minlength:"Por favor seleccione al menos 1 Funcionario involucrado"},summary:{required:"Por favor ingrese el resumen del caso"},main_multimedia:{accept:"Unicamente se aceptan imágenes"},home_image:{accept:"Unicamente se aceptan imágenes"},title:{required:"Por favor ingrese el título del Caso de Corrupción"},history:{required:"Por favor ingrese los antecedentes del caso"},history_image:{accept:"Unicamente se aceptan imágenes"},consequences_image:{accept:"Unicamente se aceptan imágenes"}},invalidHandler:function(e,i){a.hide(),o.show()},errorPlacement:function(e,o){o.is(":checkbox")?e.insertAfter(o.closest(".md-checkbox-list, .md-checkbox-inline, .checkbox-list, .checkbox-inline")):o.is(":radio")?e.insertAfter(o.closest(".md-radio-list, .md-radio-inline, .radio-list,.radio-inline")):e.insertAfter(o)},highlight:function(e){$(e).closest(".form-group").addClass("has-danger"),$(e).closest(".form-control").addClass("form-control-danger")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-danger"),$(e).closest(".form-control").removeClass("form-control-danger")},success:function(e){e.closest(".form-group").removeClass("has-danger"),e.closest(".form-control").removeClass("form-control-danger")},submitHandler:function(e){CKEDITOR.instances.summary.updateElement(),CKEDITOR.instances.history.updateElement(),CKEDITOR.instances.legal_causes.updateElement(),CKEDITOR.instances.political_causes.updateElement(),CKEDITOR.instances.economic_consequences.updateElement(),CKEDITOR.instances.social_consequences.updateElement(),CKEDITOR.instances.sources.updateElement(),a.show(),o.hide();var i=Ladda.create(document.querySelector("#corruptionCaseBtn"));i.start(),i.setProgress(-1);var n=new FormData;$("#main_multimedia")[0].files[0]&&n.append("main_multimedia",$("#main_multimedia")[0].files[0]),$("#home_image")[0].files[0]&&n.append("home_image",$("#home_image")[0].files[0]),$("#history_image")[0].files[0]&&n.append("history_image",$("#history_image")[0].files[0]),$("#consequences_image")[0].files[0]&&n.append("consequences_image",$("#consequences_image")[0].files[0]);var t=$(e).serializeArray();$.each(t,function(e,o){n.append(o.name,o.value)}),$.ajax({type:$(e).attr("method"),url:$(e).attr("action"),data:n,cache:!1,contentType:!1,processData:!1,beforeSend:function(){i.start()},success:function(e){!0===e.status?renderSection(urlCorruptionCasesList):swal({title:"BlaudCMS :: Casos de Corrupción",text:e.message,type:"error",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!1,confirmButtonClass:"text-danger",cancelButtonClass:"",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",cancelButtonText:""}),i.stop()},error:function(e){var o="",a="",e=e.responseJSON;$.each(e.errors,function(e,o){a+="\n"+o}),o=""!=a?"Ups! no se pudo actualizar la informacion debido a los siguientes errores: "+a:"Ups! parece que de momento el sistema no está disponible, por favor intentalo nuevamente en unos minutos.",swal({title:"BlaudCMS :: Casos de Corrupción",text:o,type:"error",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!1,confirmButtonClass:"text-danger",cancelButtonClass:"",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",cancelButtonText:""}),i.stop()}})}})};return{init:function(){e()}}}();$(document).ready(function(){$("#corruptionCaseBtn").hide(),FormCorruptionCaseValidation.init(),$(".select2").select2(),$("#involved_number").TouchSpin(),CKEDITOR.replace("summary",CKEditorOptions),CKEDITOR.replace("history",CKEditorOptions),CKEDITOR.replace("legal_causes",CKEditorOptions),CKEDITOR.replace("political_causes",CKEditorOptions),CKEDITOR.replace("economic_consequences",CKEditorOptions),CKEDITOR.replace("social_consequences",CKEditorOptions),CKEDITOR.replace("sources",CKEditorOptions),$("#main_multimedia").dropify({messages:{default:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",replace:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",remove:"Quitar",error:"Ups! parece que algo no esta bien"},error:{fileSize:"El archivo es demasiado grande. ({{ value }} maximo).",minWidth:"La imagen es muy pequeña. ({{ value }}}px minimo).",maxWidth:"El ancho de la imagen es muy grande. ({{ value }}}px maximo).",minHeight:"El alto de la imagen es muy pequeño. ({{ value }}}px minimo).",maxHeight:"El alto de la imagen es muy grande. ({{ value }}px maximo).",imageFormat:"Este formato no esta permitido. ({{ value }} unicamente)."}}),$("#home_image").dropify({messages:{default:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",replace:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",remove:"Quitar",error:"Ups! parece que algo no esta bien"},error:{fileSize:"El archivo es demasiado grande. ({{ value }} maximo).",minWidth:"La imagen es muy pequeña. ({{ value }}}px minimo).",maxWidth:"El ancho de la imagen es muy grande. ({{ value }}}px maximo).",minHeight:"El alto de la imagen es muy pequeño. ({{ value }}}px minimo).",maxHeight:"El alto de la imagen es muy grande. ({{ value }}px maximo).",imageFormat:"Este formato no esta permitido. ({{ value }} unicamente)."}}),$("#history_image").dropify({messages:{default:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",replace:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",remove:"Quitar",error:"Ups! parece que algo no esta bien"},error:{fileSize:"El archivo es demasiado grande. ({{ value }} maximo).",minWidth:"La imagen es muy pequeña. ({{ value }}}px minimo).",maxWidth:"El ancho de la imagen es muy grande. ({{ value }}}px maximo).",minHeight:"El alto de la imagen es muy pequeño. ({{ value }}}px minimo).",maxHeight:"El alto de la imagen es muy grande. ({{ value }}px maximo).",imageFormat:"Este formato no esta permitido. ({{ value }} unicamente)."}}),$("#consequences_image").dropify({messages:{default:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",replace:"Arrastre un archivo hasta este lugar o de un clic para seleccionar uno",remove:"Quitar",error:"Ups! parece que algo no esta bien"},error:{fileSize:"El archivo es demasiado grande. ({{ value }} maximo).",minWidth:"La imagen es muy pequeña. ({{ value }}}px minimo).",maxWidth:"El ancho de la imagen es muy grande. ({{ value }}}px maximo).",minHeight:"El alto de la imagen es muy pequeño. ({{ value }}}px minimo).",maxHeight:"El alto de la imagen es muy grande. ({{ value }}px maximo).",imageFormat:"Este formato no esta permitido. ({{ value }} unicamente)."}})});
