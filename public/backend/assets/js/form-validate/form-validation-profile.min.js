var FormProfileValidation=function(){var e=function(){function e(){return $("#password").val().length>0}var r=$("#profileForm"),o=$(".alert-danger",r),n=$(".alert-success",r);r.validate({errorElement:"div",errorClass:"form-control-feedback",focusInvalid:!1,ignore:"",rules:{name:{minlength:2,required:!0},lastname:{minlength:2,required:!0},avatar:{accept:"image/*"},password:{required:e,minlength:{param:6,depends:e}},password_confirmation:{required:e,minlength:{param:6,depends:e},equalTo:{param:"#password",depends:e}}},messages:{name:{required:"Por favor ingrese su nombre",minlength:jQuery.validator.format("Su nombre debe tener al menos {0} caracteres.")},lastname:{required:"Por favor ingrese su apellido",minlength:jQuery.validator.format("Su apellido debe tener al menos {0} caracteres.")},avatar:{accept:"Unicamente archivos de imagenes (PNG, JPG, JPEG, GIF)"},password:{required:"Por favor ingrese su clave",minlength:jQuery.validator.format("Por favor ingrese al menos {0} caracteres")},password_confirmation:{required:"Por favor ingrese la confirmación de su clave",minlength:jQuery.validator.format("Por favor ingrese al menos {0} caracteres"),equalTo:"La clave y la confirmación no coinciden"}},invalidHandler:function(e,r){n.hide(),o.show()},errorPlacement:function(e,r){r.is(":checkbox")?e.insertAfter(r.closest(".md-checkbox-list, .md-checkbox-inline, .checkbox-list, .checkbox-inline")):r.is(":radio")?e.insertAfter(r.closest(".md-radio-list, .md-radio-inline, .radio-list,.radio-inline")):e.insertAfter(r)},highlight:function(e){$(e).closest(".form-group").addClass("has-danger"),$(e).closest(".form-control").addClass("form-control-danger")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-danger"),$(e).closest(".form-control").removeClass("form-control-danger")},success:function(e){e.closest(".form-group").removeClass("has-danger"),e.closest(".form-control").removeClass("form-control-danger")},submitHandler:function(e){n.show(),o.hide();var r=Ladda.create(document.querySelector("#profileBtn"));r.start(),r.setProgress(-1);var a=new FormData;$("#avatar")[0].files[0]&&a.append("avatar",$("#avatar")[0].files[0]);var t=$(e).serializeArray();$.each(t,function(e,r){a.append(r.name,r.value)}),$.ajax({type:$(e).attr("method"),url:$(e).attr("action"),data:a,cache:!1,contentType:!1,processData:!1,beforeSend:function(){r.start()},success:function(e){!0===e.status?(renderSection(urlProfile),swal({title:"Cuponcity.ec :: Mi Perfil",text:e.message,type:"success",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!1,confirmButtonClass:"text-success",cancelButtonClass:"",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",cancelButtonText:""})):swal({title:"Cuponcity.ec :: Mi Perfil",text:e.message,type:"error",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!1,confirmButtonClass:"text-danger",cancelButtonClass:"",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",cancelButtonText:""}),r.stop()},error:function(e){var o="",n="",e=e.responseJSON;$.each(e.errors,function(e,r){n+="\n"+r}),o=""!=n?"Ups! no se pudo actualizar su informacion debido a los siguientes errores: "+n:"Ups! parece que de momento el sistema no está disponible, por favor intentalo nuevamente en unos minutos.",swal({title:"Cuponcity.ec :: Mi Perfil",text:o,type:"error",allowOutsideClick:!0,showConfirmButton:!0,showCancelButton:!1,confirmButtonClass:"text-danger",cancelButtonClass:"",closeOnConfirm:!0,closeOnCancel:!0,confirmButtonText:"OK",cancelButtonText:""}),r.stop()}})}})};return{init:function(){e()}}}();
